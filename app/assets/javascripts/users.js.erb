$(function() {

  // Instantiate the Bloodhound suggestion engine
  var foods = new Bloodhound({
      datumTokenizer: function (datum) {
          return Bloodhound.tokenizers.whitespace(datum.value);
      },
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      remote: {
          url: 'https://www.nutritionix.com/track-api/v2/search/instant?branded=false&common=true&self=false&query=%QUERY',
          wildcard: '%QUERY',
          filter: function (foods) {
              // Map the remote source JSON array to a JavaScript object array
              return $.map(foods.common, function (food) {
                  return {
                      value: food.food_name
                  };
              });
          }
      }
  });

  // Initialize the Bloodhound suggestion engine
  foods.initialize();

  // Instantiate the Typeahead UI
  $('.typeahead').typeahead(null, {
      displayKey: 'value',
      source: foods.ttAdapter()
  });



  $('.remove-food').click(function(event){
    event.stopPropagation();
    event.preventDefault();
    var removed_food = $(this).parent().parent();
    $.ajax({
      method: 'GET',
      url: $(this).parent().attr('href')
    }).done(function(){
      removed_food[0].remove();
    });
  });

  // $('.still-have').click(function(event){
  //   event.stopPropagation();
  //   event.preventDefault();
  //   var pantry_food = $(this).parent().parent();
  //   $.ajax({
  //       url: $(this).parent().attr('href'),
  //       method: 'get'
  //     }).always(function(){
  //       pantry_food[0].remove();
  //       var image = pantry_food[0].getElementsByClassName('still-have')[0];
  //       $(image).attr('src','/assets/add-to-list-95f1f0d1188270bdd8dfba963b8bd1a9029f468287f73c968f9510deed19b53a.png');
  //       $('#pantry-list').append(pantry_food[0]);
  //       //need to change link/image from 'add to pantry' stuff to 'add to list' stuff
  //     });
  // });
  //
  // $('.add-to-list').click(function(event){
  //   event.stopPropagation();
  //   event.preventDefault();
  //   var pantry_food = $(this).parent().parent();
  //   $.ajax({
  //       url: $(this).parent().attr('href'),
  //       method: 'get'
  //     }).always(function(){
  //       pantry_food[0].remove();
  //       var image = pantry_food[0].getElementsByClassName('add-to-list')[0];
  //       $(image).attr('src','/assets/pantry-8cc736bbf97b3d8e1aac39f6d427c2878ea2378cd2d7435ab333308a00e1faa1.png');
  //       $('#main-list').append(pantry_food[0]);
  //       //need to change link/image from 'add to list' stuff to 'add to pantry' stuff
  //     });
  // });

  $('.food-name').click(function(event){
    event.stopPropagation();
    event.preventDefault();
    $(this).toggleClass('strike');
  });

});
